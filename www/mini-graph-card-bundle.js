function _templateObject22(){const a=_taggedTemplateLiteral(["\n          <div class='info__item'>\n            <span class='info__item__type'>","</span>\n            <span class='info__item__value'>\n              ","\n              ","\n            </span>\n            <span class='info__item__time'>\n              ","\n            </span>\n          </div>"]);return _templateObject22=function(){return a},a}function _templateObject21(){const a=_taggedTemplateLiteral(["\n      <div class='info flex'>\n        ","\n      </div>"]);return _templateObject21=function(){return a},a}function _templateObject20(){const a=_taggedTemplateLiteral(["\n      <div class='graph__labels flex'>\n        <span class='label--max'>","</span>\n        <span class='label--min'>","</span>\n      </div>"]);return _templateObject20=function(){return a},a}function _templateObject19(){const a=_taggedTemplateLiteral(["\n      <svg width='100%' height='100%' viewBox='0 0 500 ","'\n        @click=",">\n        <g>\n          ","\n          ","\n          ","\n        </g>\n        ","\n      </svg>"]);return _templateObject19=function(){return a},a}function _templateObject18(){const a=_taggedTemplateLiteral(["<defs>","</defs>"]);return _templateObject18=function(){return a},a}function _templateObject17(){const a=_taggedTemplateLiteral(["\n            <stop stop-color=","\n              offset=","\n            />\n          "]);return _templateObject17=function(){return a},a}function _templateObject16(){const a=_taggedTemplateLiteral(["\n        <linearGradient id=",">\n          ","\n        </linearGradient>"]);return _templateObject16=function(){return a},a}function _templateObject15(){const a=_taggedTemplateLiteral(["\n          <circle\n            class='line--point' .id="," .value="," .entity=","\n            stroke=","\n            fill=","\n            cx="," cy="," r=","\n            @mouseover=","\n            @mouseout=","\n          />"]);return _templateObject15=function(){return a},a}function _templateObject14(){const a=_taggedTemplateLiteral(["\n      <g class='line--points'\n        ?init=","\n        anim=","\n        style=\"animation-delay: ","\"\n        fill=","\n        stroke=","\n        stroke-width=",">\n        ","\n      </g>"]);return _templateObject14=function(){return a},a}function _templateObject13(){const a=_taggedTemplateLiteral(["\n      <path\n        class='line'\n        .id="," anim="," ?init=","\n        style=\"animation-delay: ","\"\n        fill='none'\n        stroke-dasharray="," stroke-dashoffset=","\n        stroke=","\n        stroke-width=","\n        d=","\n      />"]);return _templateObject13=function(){return a},a}function _templateObject12(){const a=_taggedTemplateLiteral(["\n      <defs>\n        <linearGradient id="," x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n          <stop stop-color="," offset='0%' stop-opacity='1'/>\n          <stop stop-color="," offset='100%' stop-opacity='.15'/>\n        </linearGradient>\n      </defs>\n      <path\n        class='line--fill'\n        type=","\n        .id="," anim="," ?init=","\n        style=\"animation-delay: ","\"\n        fill=","\n        stroke=","\n        stroke-width=","\n        d=","\n      />"]);return _templateObject12=function(){return a},a}function _templateObject11(){const a=_taggedTemplateLiteral(["\n        <div class='graph__legend__item' @click=",">\n          <svg width='10' height='10'>\n            <rect width='10' height='10' fill="," />\n          </svg>\n          <span class='ellipsis'>","</span>\n        </div>\n      "]);return _templateObject11=function(){return a},a}function _templateObject10(){const a=_taggedTemplateLiteral(["\n      <div class='graph__legend'>\n      ","\n      </div>"]);return _templateObject10=function(){return a},a}function _templateObject9(){const a=_taggedTemplateLiteral(["\n      <div class='graph'>\n        <div class='graph__container'>\n          ","\n          <div class='graph__container__svg'>\n            ","\n          </div>\n        </div>\n        ","\n      </div>"]);return _templateObject9=function(){return a},a}function _templateObject8(){const a=_taggedTemplateLiteral(["\n      <div class='state__time'>\n        <span>","</span> - <span>","</span>\n      </div>"]);return _templateObject8=function(){return a},a}function _templateObject7(){const a=_taggedTemplateLiteral(["\n        <div class='state state--small'>\n          <span class='state__value ellipsis'>\n            ","\n          </span>\n          <span class='state__uom ellipsis'>\n            ","\n          </span>\n        </div>"]);return _templateObject7=function(){return a},a}function _templateObject6(){const a=_taggedTemplateLiteral(["\n        <div class='states flex' loc=",">\n          <div class='state'>\n            <span class='state__value ellipsis'>\n              ","\n            </span>\n            <span class='state__uom ellipsis'>\n              ","\n            </span>\n            ","\n          </div>\n          <div class='states--secondary'>","</div>\n          ","\n        </div>"]);return _templateObject6=function(){return a},a}function _templateObject5(){const a=_taggedTemplateLiteral(["\n      <div class='name flex'>\n        <span class='ellipsis'>","</span>\n      </div>"]);return _templateObject5=function(){return a},a}function _templateObject4(){const a=_taggedTemplateLiteral(["\n      <div class='icon' loc=",">\n        <ha-icon .icon=","></ha-icon>\n      </div>"]);return _templateObject4=function(){return a},a}function _templateObject3(){const a=_taggedTemplateLiteral(["\n      <div class='header flex' loc=",">\n        ","\n        ","\n      </div>"]);return _templateObject3=function(){return a},a}function _templateObject2(){const a=_taggedTemplateLiteral(["\n      <ha-card\n        class='flex'\n        ?group=","\n        ?fill=","\n        ?points=","\n        ?labels=","\n        ?gradient=","\n        ?more-info=","\n        style='font-size: ","px;'\n        @click=",">\n        ","\n        ","\n        ","\n        ","\n      </ha-card>"]);return _templateObject2=function(){return a},a}function _templateObject(){const a=_taggedTemplateLiteral(["\n  :host {\n    display: flex;\n    flex-direction: column;\n  }\n  ha-card {\n    flex-direction: column;\n    flex: 1;\n    padding: 16px 0;\n    position: relative;\n    overflow: visible;\n  }\n  ha-card > div {\n    padding: 0px 16px 16px 16px;\n  }\n  ha-card > div:last-child {\n    padding-bottom: 0;\n  }\n  ha-card[points] .line--points,\n  ha-card[labels] .graph__labels {\n    opacity: 0;\n    transition: opacity .25s;\n    animation: none;\n  }\n  ha-card[points]:hover .line--points,\n  ha-card:hover .graph__labels {\n    opacity: 1;\n  }\n  ha-card[fill] {\n    padding-bottom: 0;\n  }\n  ha-card[fill] .graph {\n    padding: 0;\n    order: 10;\n  }\n  ha-card[fill] path {\n    stroke-linecap: initial;\n    stroke-linejoin: initial;\n  }\n  ha-card[fill] .graph__legend {\n    order: -1;\n    padding: 0 16px 8px 16px;\n  }\n  ha-card[fill] .info {\n    padding-bottom: 16px;\n  }\n  ha-card[group] {\n    box-shadow: none;\n    padding: 0;\n  }\n  ha-card[group] > div {\n    padding: 0;\n  }\n  ha-card[group] .graph__legend {\n    padding-left: 0;\n    padding-right: 0;\n  }\n  ha-card[more-info] {\n    cursor: pointer;\n  }\n  .flex {\n    display: flex;\n    display: -webkit-flex;\n    min-width: 0;\n  }\n  .header {\n    justify-content: space-between;\n  }\n  .header[loc=\"center\"] {\n    align-self: center;\n  }\n  .header[loc=\"left\"] {\n    align-self: flex-start;\n  }\n  .header[loc=\"right\"] {\n    align-self: flex-end;\n  }\n  .name {\n    align-items: center;\n    min-width: 0;\n    opacity: .8;\n  }\n  .name > span {\n    font-size: 1.2rem;\n    font-weight: 400;\n    max-height: 1.4rem;\n    opacity: .75;\n  }\n  .icon {\n    color: var(--paper-item-icon-color, #44739e);\n    display: inline-block;\n    flex: 0 0 24px;\n    text-align: center;\n    width: 24px;\n    margin-left: auto;\n  }\n  .icon[loc=\"left\"] {\n    order: -1;\n    margin-right: 8px;\n    margin-left: 0;\n  }\n  .icon[loc=\"state\"] {\n    align-self: center;\n  }\n  .states {\n    align-items: flex-start;\n    font-weight: 300;\n    justify-content: space-between;\n    flex-wrap: nowrap;\n  }\n  .states .icon {\n    align-self: center;\n    margin-left: 0;\n  }\n  .states[loc=\"center\"] {\n    justify-content: space-around;\n  }\n  .states[loc=\"right\"] > .state {\n    margin-left: auto;\n    order: 2;\n  }\n  .states[loc=\"right\"] > .icon {\n    margin-left: 0;\n  }\n  .states[loc=\"center\"] .states--secondary,\n  .states[loc=\"right\"] .states--secondary {\n    margin-left: 0;\n  }\n  .states--secondary {\n    display: flex;\n    font-size: 0.6em;\n    flex-flow: column;\n    flex-wrap: wrap;\n    margin-left: 1rem;\n    min-width: 0;\n  }\n  .states--secondary:empty {\n    display: none;\n  }\n  .state {\n    position: relative;\n    display: flex;\n    flex-wrap: wrap;\n    max-width: 100%;\n    min-width: 0;\n  }\n  .state--small {\n    margin-bottom: .6rem;\n    flex-wrap: nowrap;\n  }\n  .state__value {\n    display: inline-block;\n    font-size: 2.4em;\n    line-height: 1em;\n    margin-right: .25rem;\n  }\n  .state__uom {\n    align-self: flex-end;\n    display: inline-block;\n    font-size: 1.4em;\n    font-weight: 400;\n    line-height: 1.2em;\n    margin-top: .1em;\n    opacity: .6;\n    vertical-align: bottom;\n  }\n  .state--small .state__uom {\n    flex: 1;\n  }\n  .state__time {\n    font-size: .95rem;\n    font-weight: 500;\n    bottom: -1.1rem;\n    left: 0;\n    opacity: .75;\n    position: absolute;\n    white-space: nowrap;\n  }\n  .states[loc=\"right\"] .state__time {\n    left: initial;\n    right: 0;\n  }\n  .graph {\n    align-self: flex-end;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: column;\n    margin-top: auto;\n    width: 100%;\n  }\n  .graph__container {\n    display: flex;\n    flex-direction: row;\n    position: relative;\n  }\n  .graph__container__svg {\n    cursor: default;\n    flex: 1;\n  }\n  svg {\n    overflow: hidden;\n  }\n  path {\n    stroke-linecap: round;\n    stroke-linejoin: round;\n  }\n  .line--fill[anim=\"false\"] {\n    animation: reveal .25s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line--fill[anim=\"false\"][type=\"fade\"] {\n    animation: reveal-2 .25s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line--points[anim=\"false\"],\n  .line[anim=\"false\"] {\n    animation: pop .25s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line--point {\n    cursor: pointer;\n    fill: var(--paper-card-background-color, white);\n    stroke-width: inherit;\n    transition: fill .15s cubic-bezier(0.215, 0.61, 0.355, 1);\n  }\n  .line--point:hover {\n    fill: inherit;\n  }\n  ha-card[gradient] .line--point:hover {\n    fill: var(--primary-text-color, white);\n  }\n  path,\n  .line--points,\n  .line--fill {\n    opacity: 0;\n  }\n  .line--points[anim=\"true\"][init] {\n    animation: pop .5s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line--fill[anim=\"true\"][init] {\n    animation: reveal .5s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line--fill[anim=\"true\"][init][type=\"fade\"] {\n    animation: reveal-2 .5s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .line[anim=\"true\"][init] {\n    animation: dash 1s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;\n  }\n  .graph__labels {\n    align-items: flex-start;\n    flex-direction: column;\n    font-size: calc(.15em + 8.5px);\n    font-weight: 400;\n    justify-content: space-between;\n    margin-right: 10px;\n    padding: .6em;\n    position: absolute;\n    pointer-events: none;\n    top: 0; bottom: 0;\n    opacity: .75;\n  }\n  .graph__labels > span {\n    cursor: pointer;\n    background: var(--primary-background-color, white);\n    border-radius: 1em;\n    padding: .2em .6em;\n    box-shadow: 0 1px 3px rgba(0,0,0,.12), 0 1px 2px rgba(0,0,0,.24);\n  }\n  .graph__legend {\n    display: flex;\n    flex-direction: row;\n    justify-content: space-evenly;\n    padding-top: 16px;\n    flex-wrap: wrap;\n  }\n  .graph__legend__item {\n    cursor: pointer;\n    display: flex;\n    min-width: 0;\n    margin: .4em;\n    align-items: center\n  }\n  .graph__legend__item span {\n    opacity: .75;\n    margin-left: .4em;\n  }\n  .info {\n    justify-content: space-between;\n    align-items: middle;\n  }\n  .info__item {\n    display: flex;\n    flex-flow: column;\n    align-items: flex-end;\n    text-align: right;\n  }\n  .info__item:first-child {\n    align-items: flex-start;\n    text-align: left;\n  }\n  .info__item__type {\n    text-transform: capitalize;\n    font-weight: 500;\n    opacity: .9;\n  }\n  .info__item__time,\n  .info__item__value {\n    opacity: .75;\n  }\n  .ellipsis {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n  @keyframes reveal {\n    0% { opacity: 0; }\n    100% { opacity: .15; }\n  }\n  @keyframes reveal-2 {\n    0% { opacity: 0; }\n    100% { opacity: .4; }\n  }\n  @keyframes pop {\n    0% { opacity: 0; }\n    100% { opacity: 1; }\n  }\n  @keyframes dash {\n    0% {\n      opacity: 0;\n    }\n    25% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 1;\n      stroke-dashoffset: 0;\n    }\n  }"]);return _templateObject=function(){return a},a}function _taggedTemplateLiteral(a,b){return b||(b=a.slice(0)),Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(b)}}))}function _objectSpread(a){for(var b=1;b<arguments.length;b++){var c=null==arguments[b]?{}:arguments[b],d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){_defineProperty(a,b,c[b])})}return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b():"function"==typeof define&&define.amd?define(b):b()}(0,function(){"use strict";var Q=Number.isNaN,R=Math.max,T=Math.min,Y=Math.abs,aa=Math.floor;function J(a){let b=E.get(a.type);void 0===b&&(b={stringsArray:new WeakMap,keyString:new Map},E.set(a.type,b));let d=b.stringsArray.get(a.strings);if(void 0!==d)return d;const f=a.strings.join(r);return void 0===(d=b.keyString.get(f))&&(d=new c(a,a.getTemplateElement()),b.keyString.set(f,d)),b.stringsArray.set(a.strings,d),d}function K(b,c){const d=b.element.content,e=b.parts,f=document.createTreeWalker(d,133,null,!1);let g=U(e),i=e[g],j=-1,k=0;const m=[];for(let a=null;f.nextNode();){j++;const b=f.currentNode;for(b.previousSibling==="$lit$"&&(a=null),c.has(b)&&(m.push(b),!1),k++;void 0!==i&&i.index===j;)i.index=-1,i=e[g=U(e,g)]}m.forEach(a=>a.parentNode.removeChild(a))}const ba=new WeakMap,ca=a=>"function"==typeof a&&ba.has(a),da=void 0!==window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,ea=function(a,b){let c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null,f=b;for(;f!==c;){const b=f.nextSibling;a.insertBefore(f,d),f=b}},fa=function(a,b){let c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,d=b;for(;d!==c;){const b=d.nextSibling;a.removeChild(d),d=b}},e={},i={},r="{{lit-".concat((Math.random()+"").slice(2),"}}"),a="<!--".concat(r,"-->"),l=new RegExp("".concat(r,"|").concat(a)),h="$lit$";class c{constructor(b,a){this.parts=[],this.element=a;let c=-1,f=0;const g=[],d=a=>{const e=a.content,i=document.createTreeWalker(e,133,null,!1);for(let j=0;i.nextNode();){c++;const k=i.currentNode;if(1===k.nodeType){if(k.hasAttributes()){const a=k.attributes;let d=0;for(let b=0;b<a.length;b++)0<=a[b].value.indexOf(r)&&d++;for(;0<d--;){const d=b.strings[f],e=u.exec(d)[2],g=e.toLowerCase()+h,i=k.getAttribute(g).split(l);this.parts.push({type:"attribute",index:c,name:e,strings:i}),k.removeAttribute(g),f+=i.length-1}}"TEMPLATE"===k.tagName&&d(k)}else if(3===k.nodeType){const b=k.data;if(0<=b.indexOf(r)){const d=k.parentNode,e=b.split(l),h=e.length-1;for(let a=0;a<h;a++)d.insertBefore(""===e[a]?p():document.createTextNode(e[a]),k),this.parts.push({type:"node",index:++c});""===e[h]?(d.insertBefore(p(),k),g.push(k)):k.data=e[h],f+=h}}else if(8===k.nodeType)if(k.data===r){const a=k.parentNode;null!==k.previousSibling&&c!==j||(c++,a.insertBefore(p(),k)),j=c,this.parts.push({type:"node",index:c}),null===k.nextSibling?k.data="":(g.push(k),c--),f++}else for(let a=-1;-1!==(a=k.data.indexOf(r,a+1));)this.parts.push({type:"node",index:-1})}};d(a);for(const c of g)c.parentNode.removeChild(c)}}const d=a=>-1!==a.index,p=()=>document.createComment(""),u=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F \x09\x0a\x0c\x0d"'>=\/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;class m{constructor(a,b,c){this._parts=[],this.template=a,this.processor=b,this.options=c}update(a){let b=0;for(const c of this._parts)void 0!==c&&c.setValue(a[b]),b++;for(const b of this._parts)void 0!==b&&b.commit()}_clone(){const a=da?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),b=this.template.parts;let c=0,e=0;const f=a=>{const g=document.createTreeWalker(a,133,null,!1);for(let h=g.nextNode();c<b.length&&!0;){const a=b[c];if(!d(a))this._parts.push(void 0),c++;else if(e===a.index){if("node"===a.type){const a=this.processor.handleTextExpression(this.options);a.insertAfterNode(h.previousSibling),this._parts.push(a)}else this._parts.push(...this.processor.handleAttributeExpressions(h,a.name,a.strings,this.options));c++}else e++,"TEMPLATE"===h.nodeName&&f(h.content),h=g.nextNode()}};return f(a),da&&(document.adoptNode(a),customElements.upgrade(a)),a}}class f{constructor(a,b,c,d){this.strings=a,this.values=b,this.type=c,this.processor=d}getHTML(){const b=this.strings.length-1;let c="";for(let d=0;d<b;d++){const b=this.strings[d],e=u.exec(b);c+=e?b.substr(0,e.index)+e[1]+e[2]+h+e[3]+r:b+a}return c+this.strings[b]}getTemplateElement(){const a=document.createElement("template");return a.innerHTML=this.getHTML(),a}}class g extends f{getHTML(){return"<svg>".concat(super.getHTML(),"</svg>")}getTemplateElement(){const a=super.getTemplateElement(),b=a.content,c=b.firstChild;return b.removeChild(c),ea(b,c.firstChild),a}}const n=a=>null===a||"object"!=typeof a&&"function"!=typeof a;class o{constructor(a,b,c){this.dirty=!0,this.element=a,this.name=b,this.strings=c,this.parts=[];for(let d=0;d<c.length-1;d++)this.parts[d]=this._createPart()}_createPart(){return new s(this)}_getValue(){const a=this.strings,b=a.length-1;let c="";for(let d=0;d<b;d++){c+=a[d];const b=this.parts[d];if(void 0!==b){const a=b.value;if(null!=a&&(Array.isArray(a)||"string"!=typeof a&&a[Symbol.iterator]))for(const b of a)c+="string"==typeof b?b:b+"";else c+="string"==typeof a?a:a+""}}return c+=a[b]}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class s{constructor(a){this.value=void 0,this.committer=a}setValue(a){a===e||n(a)&&a===this.value||(this.value=a,ca(a)||(this.committer.dirty=!0))}commit(){for(;ca(this.value);){const a=this.value;this.value=e,a(this)}this.value!==e&&this.committer.commit()}}class v{constructor(a){this.value=void 0,this._pendingValue=void 0,this.options=a}appendInto(a){this.startNode=a.appendChild(p()),this.endNode=a.appendChild(p())}insertAfterNode(a){this.startNode=a,this.endNode=a.nextSibling}appendIntoPart(a){a._insert(this.startNode=p()),a._insert(this.endNode=p())}insertAfterPart(a){a._insert(this.startNode=p()),this.endNode=a.endNode,a.endNode=this.startNode}setValue(a){this._pendingValue=a}commit(){for(;ca(this._pendingValue);){const a=this._pendingValue;this._pendingValue=e,a(this)}const a=this._pendingValue;a!==e&&(n(a)?a!==this.value&&this._commitText(a):a instanceof f?this._commitTemplateResult(a):a instanceof Node?this._commitNode(a):Array.isArray(a)||a[Symbol.iterator]?this._commitIterable(a):a===i?(this.value=i,this.clear()):this._commitText(a))}_insert(a){this.endNode.parentNode.insertBefore(a,this.endNode)}_commitNode(a){this.value!==a&&(this.clear(),this._insert(a),this.value=a)}_commitText(a){const b=this.startNode.nextSibling;a=null==a?"":a,b===this.endNode.previousSibling&&3===b.nodeType?b.data=a:this._commitNode(document.createTextNode("string"==typeof a?a:a+"")),this.value=a}_commitTemplateResult(a){const b=this.options.templateFactory(a);if(this.value instanceof m&&this.value.template===b)this.value.update(a.values);else{const c=new m(b,a.processor,this.options),d=c._clone();c.update(a.values),this._commitNode(d),this.value=c}}_commitIterable(a){Array.isArray(this.value)||(this.value=[],this.clear());const b=this.value;let c,d=0;for(const e of a)void 0===(c=b[d])&&(c=new v(this.options),b.push(c),0==d?c.appendIntoPart(this):c.insertAfterPart(b[d-1])),c.setValue(e),c.commit(),d++;d<b.length&&(b.length=d,this.clear(c&&c.endNode))}clear(){let a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.startNode;fa(this.startNode.parentNode,a.nextSibling,this.endNode)}}class b{constructor(a,b,c){if(this.value=void 0,this._pendingValue=void 0,2!==c.length||""!==c[0]||""!==c[1])throw new Error("Boolean attributes can only contain a single expression");this.element=a,this.name=b,this.strings=c}setValue(a){this._pendingValue=a}commit(){for(;ca(this._pendingValue);){const a=this._pendingValue;this._pendingValue=e,a(this)}if(this._pendingValue!==e){const a=!!this._pendingValue;this.value!==a&&(a?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name)),this.value=a,this._pendingValue=e}}}class w extends o{constructor(a,b,c){super(a,b,c),this.single=2===c.length&&""===c[0]&&""===c[1]}_createPart(){return new t(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class t extends s{}let x=!1;try{const a={get capture(){return x=!0,!1}};window.addEventListener("test",a,a),window.removeEventListener("test",a,a)}catch(a){}class y{constructor(a,b,c){this.value=void 0,this._pendingValue=void 0,this.element=a,this.eventName=b,this.eventContext=c,this._boundHandleEvent=a=>this.handleEvent(a)}setValue(a){this._pendingValue=a}commit(){for(;ca(this._pendingValue);){const a=this._pendingValue;this._pendingValue=e,a(this)}if(this._pendingValue!==e){const a=this._pendingValue,b=this.value,c=null==a||null!=b&&(a.capture!==b.capture||a.once!==b.once||a.passive!==b.passive);c&&this.element.removeEventListener(this.eventName,this._boundHandleEvent,this._options),null!=a&&(null==b||c)&&(this._options=N(a),this.element.addEventListener(this.eventName,this._boundHandleEvent,this._options)),this.value=a,this._pendingValue=e}}handleEvent(a){"function"==typeof this.value?this.value.call(this.eventContext||this.element,a):this.value.handleEvent(a)}}const N=a=>a&&(x?{capture:a.capture,passive:a.passive,once:a.once}:a.capture),C=new class{handleAttributeExpressions(a,c,d,e){const f=c[0];return"."===f?new w(a,c.slice(1),d).parts:"@"===f?[new y(a,c.slice(1),e.eventContext)]:"?"===f?[new b(a,c.slice(1),d)]:new o(a,c,d).parts}handleTextExpression(a){return new v(a)}},E=new Map,A=new WeakMap;(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.0.0");const k=function(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return new f(a,c,"html",C)},S=function(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return new g(a,c,"svg",C)},M=133,z=a=>{let b=11===a.nodeType?0:1;for(const c=document.createTreeWalker(a,M,null,!1);c.nextNode();)b++;return b},U=function(a){let b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:-1;for(let c=b+1;c<a.length;c++){const b=a[c];if(d(b))return c}return-1},O=(a,b)=>"".concat(a,"--").concat(b);let G=!0;void 0===window.ShadyCSS?G=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected.Please update to at least @webcomponents/webcomponentsjs@2.0.2 and@webcomponents/shadycss@1.3.1."),G=!1);const V=["html","svg"],j=new Set,F=(a,b,c)=>{j.add(c);const d=a.querySelectorAll("style");if(0===d.length)return void window.ShadyCSS.prepareTemplateStyles(b.element,c);const f=document.createElement("style");for(let g=0;g<d.length;g++){const a=d[g];a.parentNode.removeChild(a),f.textContent+=a.textContent}if((a=>{V.forEach(b=>{const c=E.get(O(b,a));void 0!==c&&c.keyString.forEach(a=>{const b=a.element.content,c=new Set;Array.from(b.querySelectorAll("style")).forEach(a=>{c.add(a)}),K(a,c)})})})(c),function(a,b){let c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;const d=a.element.content,e=a.parts;if(null==c)return void d.appendChild(b);const f=document.createTreeWalker(d,M,null,!1);for(let d=U(e),g=0,h=-1;f.nextNode();)for(h++,f.currentNode===c&&(g=z(b),c.parentNode.insertBefore(b,c));e[d].index===h;){if(0<g){for(;;)e[d].index+=g,d=U(e,d);return}d=U(e,d)}}(b,f,b.element.content.firstChild),window.ShadyCSS.prepareTemplateStyles(b.element,c),window.ShadyCSS.nativeShadow){const c=b.element.content.querySelector("style");a.insertBefore(c.cloneNode(!0),a.firstChild)}else{b.element.content.insertBefore(f,b.element.content.firstChild);const a=new Set;a.add(f),K(b,a)}};window.JSCompiler_renameProperty=a=>a;const I={toAttribute(a,b){return b===Boolean?a?"":null:b===Object||b===Array?null==a?a:JSON.stringify(a):a},fromAttribute(a,b){return b===Boolean?null!==a:b===Number?null===a?null:+a:b===Object||b===Array?JSON.parse(a):a}},H=(a,b)=>b!==a&&(b==b||a==a),q={attribute:!0,type:String,converter:I,reflect:!1,hasChanged:H},B=Promise.resolve(!0),D=1;class W extends HTMLElement{constructor(){super(),this._updateState=0,this._instanceProperties=void 0,this._updatePromise=B,this._hasConnectedResolver=void 0,this._changedProperties=new Map,this._reflectingProperties=void 0,this.initialize()}static get observedAttributes(){this.finalize();const a=[];return this._classProperties.forEach((b,c)=>{const d=this._attributeNameForProperty(c,b);void 0!==d&&(this._attributeToPropertyMap.set(d,c),a.push(d))}),a}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const a=Object.getPrototypeOf(this)._classProperties;void 0!==a&&a.forEach((a,b)=>this._classProperties.set(b,a))}}static createProperty(a){let b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:q;if(this._ensureClassProperties(),this._classProperties.set(a,b),b.noAccessor||this.prototype.hasOwnProperty(a))return;const c="symbol"==typeof a?Symbol():"__".concat(a);Object.defineProperty(this.prototype,a,{get(){return this[c]},set(b){const d=this[a];this[c]=b,this.requestUpdate(a,d)},configurable:!0,enumerable:!0})}static finalize(){if(!(this.hasOwnProperty(JSCompiler_renameProperty("finalized",this))&&this.finalized)){const a=Object.getPrototypeOf(this);if("function"==typeof a.finalize&&a.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const a=this.properties,b=[...Object.getOwnPropertyNames(a),...("function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(a):[])];for(const c of b)this.createProperty(c,a[c])}}}static _attributeNameForProperty(a,b){const c=b.attribute;return!1===c?void 0:"string"==typeof c?c:"string"==typeof a?a.toLowerCase():void 0}static _valueHasChanged(a,b){let c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:H;return c(a,b)}static _propertyValueFromAttribute(a,b){const c=b.type,d=b.converter||I,e="function"==typeof d?d:d.fromAttribute;return e?e(a,c):a}static _propertyValueToAttribute(a,b){if(void 0!==b.reflect){const c=b.type,d=b.converter;return(d&&d.toAttribute||I.toAttribute)(a,c)}}initialize(){this._saveInstanceProperties()}_saveInstanceProperties(){this.constructor._classProperties.forEach((a,b)=>{if(this.hasOwnProperty(b)){const a=this[b];delete this[b],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(b,a)}})}_applyInstanceProperties(){this._instanceProperties.forEach((a,b)=>this[b]=a),this._instanceProperties=void 0}connectedCallback(){this._updateState|=32,this._hasConnectedResolver?(this._hasConnectedResolver(),this._hasConnectedResolver=void 0):this.requestUpdate()}disconnectedCallback(){}attributeChangedCallback(a,b,c){b!==c&&this._attributeToProperty(a,c)}_propertyToAttribute(a,b){let c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:q;const d=this.constructor,e=d._attributeNameForProperty(a,c);if(void 0!==e){const a=d._propertyValueToAttribute(b,c);if(void 0===a)return;this._updateState|=8,null==a?this.removeAttribute(e):this.setAttribute(e,a),this._updateState&=-9}}_attributeToProperty(a,b){if(!(this._updateState&8)){const c=this.constructor,d=c._attributeToPropertyMap.get(a);if(void 0!==d){const a=c._classProperties.get(d)||q;this._updateState|=16,this[d]=c._propertyValueFromAttribute(b,a),this._updateState&=-17}}}requestUpdate(a,b){let c=!0;if(void 0!==a&&!this._changedProperties.has(a)){const d=this.constructor,e=d._classProperties.get(a)||q;d._valueHasChanged(this[a],b,e.hasChanged)?(this._changedProperties.set(a,b),!0!==e.reflect||this._updateState&16||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(a,e))):c=!1}return!this._hasRequestedUpdate&&c&&this._enqueueUpdate(),this.updateComplete}async _enqueueUpdate(){let a;this._updateState|=4;const b=this._updatePromise;this._updatePromise=new Promise(b=>a=b),await b,this._hasConnected||(await new Promise(a=>this._hasConnectedResolver=a));const c=this.performUpdate();null!=c&&"function"==typeof c.then&&(await c),a(!this._hasRequestedUpdate)}get _hasConnected(){return this._updateState&32}get _hasRequestedUpdate(){return this._updateState&4}get hasUpdated(){return this._updateState&D}performUpdate(){if(this._instanceProperties&&this._applyInstanceProperties(),this.shouldUpdate(this._changedProperties)){const a=this._changedProperties;this.update(a),this._markUpdated(),this._updateState&D||(this._updateState|=1,this.firstUpdated(a)),this.updated(a)}else this._markUpdated()}_markUpdated(){this._changedProperties=new Map,this._updateState&=-5}get updateComplete(){return this._updatePromise}shouldUpdate(){return!0}update(){void 0!==this._reflectingProperties&&0<this._reflectingProperties.size&&(this._reflectingProperties.forEach((a,b)=>this._propertyToAttribute(b,this[b],a)),this._reflectingProperties=void 0)}updated(){}firstUpdated(){}}W.finalized=!0;const X="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Z=Symbol();class ${constructor(a,b){if(b!==Z)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=a}get styleSheet(){return void 0===this._styleSheet&&(X?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}(window.litElementVersions||(window.litElementVersions=[])).push("2.0.1");const _=a=>a.flat?a.flat(1/0):function a(b){let c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[];for(let d=0,e=b.length;d<e;d++){const e=b[d];Array.isArray(e)?a(e,c):c.push(e)}return c}(a);class ga extends W{static finalize(){super.finalize(),this._styles=this.hasOwnProperty(JSCompiler_renameProperty("styles",this))?this._getUniqueStyles():this._styles||[]}static _getUniqueStyles(){const a=this.styles,b=[];return Array.isArray(a)?_(a).reduceRight((a,b)=>(a.add(b),a),new Set).forEach(a=>b.unshift(a)):a&&b.push(a),b}initialize(){super.initialize(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const a=this.constructor._styles;0!==a.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?X?this.renderRoot.adoptedStyleSheets=a.map(a=>a.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(a.map(a=>a.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(a){super.update(a);const b=this.render();b instanceof f&&this.constructor.render(b,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(a=>{const b=document.createElement("style");b.textContent=a.cssText,this.renderRoot.appendChild(b)}))}render(){}}ga.finalized=!0,ga.render=(a,b,d)=>{const e=d.scopeName,g=A.has(b),i=b instanceof ShadowRoot&&G&&a instanceof f,k=i&&!j.has(e),l=k?document.createDocumentFragment():b;if(((a,b,c)=>{let d=A.get(b);void 0===d&&(fa(b,b.firstChild),A.set(b,d=new v(Object.assign({templateFactory:J},c))),d.appendInto(b)),d.setValue(a),d.commit()})(a,l,Object.assign({templateFactory:(a=>b=>{const d=O(b.type,a);let e=E.get(d);void 0===e&&(e={stringsArray:new WeakMap,keyString:new Map},E.set(d,e));let f=e.stringsArray.get(b.strings);if(void 0!==f)return f;const g=b.strings.join(r);if(void 0===(f=e.keyString.get(g))){const d=b.getTemplateElement();G&&window.ShadyCSS.prepareTemplateDom(d,a),f=new c(b,d),e.keyString.set(g,f)}return e.stringsArray.set(b.strings,f),f})(e)},d)),k){const a=A.get(l);A.delete(l),a.value instanceof m&&F(l,a.value.template,e),fa(b,b.firstChild),b.appendChild(l),A.set(b,a)}!g&&i&&window.ShadyCSS.styleElement(b.host)};const ha=0,ia=1,ja=2;class ka{constructor(a,b,c){let d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:24,e=4<arguments.length&&arguments[4]!==void 0?arguments[4]:1;this.coords=[],this.width=a-2*c[ha],this.height=b-2*c[ia],this.margin=c,this._max=0,this._min=0,this.points=e,this.hours=d}get max(){return this._max}set max(a){this._max=a}get min(){return this._min}set min(a){this._min=a}update(a){const b=new Date().getTime(),c=(a,c)=>{const d=(b-new Date(c.last_changed).getTime())/36e5*this.points-this.hours*this.points,e=Y(aa(d));return a[e]||(a[e]=[]),a[e].push(c),a},d=a.reduce((a,b)=>c(a,b),[]);d.length=Math.ceil(this.hours*this.points+1),this.coords=this._calcPoints(d),this.min=T(...this.coords.map(a=>+a[ja])),this.max=R(...this.coords.map(a=>+a[ja]))}_calcPoints(a){const b=[];let c=this.width/(this.hours*this.points);c=Number.isFinite(c)?c:this.width;let d=[0,this._average(a.filter(Boolean)[0])];const f=(a,e)=>{const f=c*e+this.margin[ha];return a&&(d=[0,this._average(a)]),b.push([f,...d])};for(let b=0;b<a.length;b+=1)f(a[b],b);return 1===b.length&&(b[1]=[this.width+this.margin[ha],0,b[0][ja]]),b}_calcY(a){const b=(this.max-this.min)/this.height||1;return a.map(a=>[a[ha],this.height-(a[ja]-this.min)/b+1.5*this.margin[ia],a[ja]])}getPoints(){const a=this._calcY(this.coords);let b,c,d=a[0];return a.shift(),a.map((a,e)=>{b=a,c=this._midPoint(d[ha],d[ia],b[ha],b[ia]);const f=(b[ja]+d[ja])/2;return d=b,[c[ha],c[ia],f,e]})}getPath(){const a=this._calcY(this.coords);let b,c,d="",f=a[0];return d+="M".concat(f[ha],",").concat(f[ia]),a.forEach(a=>{b=a,c=this._midPoint(f[ha],f[ia],b[ha],b[ia]),d+=" ".concat(c[ha],",").concat(c[ia]),d+=" Q ".concat(b[ha],",").concat(b[ia]),f=b}),d+=" ".concat(b[ha],",").concat(b[ia])}computeGradient(b,c){const d=100/this.coords.length,a=this._calcY(this.coords);let e,f=a[0];return a.shift(),a.map((g,h)=>{const i=((e=g)[ja]+f[ja])/2;return f=e,_objectSpread({offset:d*h+d,color:c},b.find(a=>a.value<i))})}getFill(a){const b=this.height+2*this.margin[ia];let c=a;return c+=" L ".concat(this.width-2*this.margin[ha],", ").concat(b),c+=" L ".concat(this.coords[0][ha],", ").concat(b," z")}_midPoint(a,b,c,d){return[(a-c)/2+c,(b-d)/2+d]}_average(a){return a.reduce((a,b)=>a+parseFloat(b.state),0)/a.length}}const la=function(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];const e=c.reduce((b,c,d)=>b+(a=>{if(a instanceof $)return a.cssText;throw new Error("Value passed to 'css' function must be a 'css' function result: ".concat(a,". Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security."))})(c)+a[d+1],a[0]);return new $(e,Z)}(_templateObject()),ma=14,na={humidity:"hass:water-percent",illuminance:"hass:brightness-5",temperature:"hass:thermometer",battery:"hass:battery"},oa=["var(--accent-color)","#3498db","#e74c3c","#9b59b6","#f1c40f","#2ecc71"],pa=["entity","line","length","fill","points","tooltip","abs"],qa={name:!0,icon:!0,state:!0,graph:!0,labels:"hover",extrema:!1,legend:!0,fill:!0,points:"hover"},ra=(a,b)=>a.reduce((a,c)=>+c[b]<+a[b]?c:a,a[0]),sa=(a,b)=>a.reduce((a,c)=>+c[b]>+a[b]?c:a,a[0]),ta=(a,b)=>a.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!b});customElements.define("mini-graph-card",class extends ga{constructor(){super(),this.bound=[0,0],this.abs=[],this.length=[],this.entity=[],this.line=[],this.fill=[],this.points=[],this.gradient=[],this.tooltip={},this.updateQueue=[]}static get styles(){return la}set hass(a){this._hass=a;let b=!1;this.config.entities.forEach((c,d)=>{const e=a.states[c.entity];e&&this.entity[d]!==e&&(this.entity[d]=e,this.updateQueue.push(e.entity_id),b=!0)}),b&&(this.entity=[...this.entity],this.updateData())}static get properties(){return{_hass:{},config:{},entity:[],Graph:[],line:[],shadow:[],length:Number,bound:[],abs:[],tooltip:{},updateQueue:[]}}setConfig(a){if(a.entity)throw new Error("The \"entity\" option was removed, please use \"entities\".\n See ".concat("https://github.com/kalkih/mini-graph-card/blob/master/README.md"));if(!Array.isArray(a.entities))throw new Error("Please provide the \"entities\" option as a list.\n See ".concat("https://github.com/kalkih/mini-graph-card/blob/master/README.md"));if(a.line_color_above||a.line_color_below)throw new Error("\"line_color_above/line_color_below\" was removed, please use \"color_thresholds\".\n See ".concat("https://github.com/kalkih/mini-graph-card/blob/master/README.md"));const b=_objectSpread({animate:!1,hour24:!1,font_size:ma,height:100,hours_to_show:24,points_per_hour:.5,line_color:[...oa],color_thresholds:[],line_width:5,more_info:!0},a,{show:_objectSpread({},qa,a.show)});b.entities.forEach((a,c)=>{"string"==typeof a&&(b.entities[c]={entity:a})}),"string"==typeof a.line_color&&(b.line_color=[a.line_color,...oa]),b.font_size=a.font_size/100*ma||ma,b.hours_to_show=aa(+b.hours_to_show)||24,b.color_thresholds.sort((a,b)=>b.value-a.value),this.Graph||(this.Graph=b.entities.map(()=>new ka(500,b.height,[b.show.fill?0:b.line_width,b.line_width],b.hours_to_show,b.points_per_hour))),this.config=b}shouldUpdate(a){return pa.some(b=>a.has(b))}updated(a){this.config.animate&&a.has("line")&&(this.length.length<this.entity.length?(this.shadowRoot.querySelectorAll("svg path.line").forEach(a=>{this.length[a.id]=a.getTotalLength()}),this.length=[...this.length]):this.length=Array(this.entity.length).fill("none"))}render(){let a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this,b=a.config;return k(_templateObject2(),b.group,b.show.graph&&b.show.fill,"hover"===b.show.points,"hover"===b.show.labels,0<b.color_thresholds.length,b.more_info,b.font_size,a=>this.handlePopup(a,this.entity[0]),this.renderHeader(),this.renderStates(),this.renderGraph(),this.renderInfo())}renderHeader(){const a=this.config,b=a.show,c=a.align_icon,d=a.align_header;return b.name||b.icon&&"state"!==c?k(_templateObject3(),d,this.renderName(),"state"===c?"":this.renderIcon()):""}renderIcon(){return this.config.show.icon?k(_templateObject4(),this.config.align_icon,this.computeIcon(this.entity[0])):""}renderName(){if(this.config.show.name){const a=void 0===this.tooltip.entity?this.config.name||this.computeName(0):this.computeName(this.tooltip.entity);return k(_templateObject5(),a)}}renderStates(){const a=void 0===this.tooltip.value?this.entity[0].state:this.tooltip.value;if(this.config.show.state)return k(_templateObject6(),this.config.align_state,this.computeState(a),this.computeUom(this.entity[this.tooltip.entity||0]),this.renderStateTime(),this.config.entities.map((a,b)=>this.renderState(a,b)),"state"===this.config.align_icon?this.renderIcon():"")}renderState(a,b){if(a.show_state&&0!==b)return k(_templateObject7(),this.computeState(this.entity[b].state),this.computeUom(this.entity[b]))}renderStateTime(){if(void 0!==this.tooltip.value)return k(_templateObject8(),this.tooltip.time[0],this.tooltip.time[1])}renderGraph(){return this.config.show.graph?k(_templateObject9(),this.renderLabels(),this.renderSvg(),this.renderLegend()):""}renderLegend(){if(!(1>=this.config.entities.length)&&this.config.show.legend)return k(_templateObject10(),this.entity.map((a,b)=>k(_templateObject11(),b=>this.handlePopup(b,a),this.computeColor(a.state,b),this.computeName(b))))}renderSvgFill(a,b){if(a){const a=this.computeColor(this.entity[b].state,b),c="fade"===this.config.show.fill;return S(_templateObject12(),"fill-grad-".concat(b),a,a,this.config.show.fill,b,this.config.animate,this.length[b],this.config.animate?"".concat(.5*b,"s"):"0s",c?"url(#fill-grad-".concat(b,")"):a,c?"url(#fill-grad-".concat(b,")"):a,this.config.line_width,this.fill[b])}}renderSvgLine(a,b){if(a)return S(_templateObject13(),b,this.config.animate,this.length[b],this.config.animate?"".concat(.5*b,"s"):"0s",this.length[b]||"none",this.length[b]||"none",this.gradient[b]?"url(#grad-".concat(b,")"):this.computeColor(this.entity[b].state,b),this.config.line_width,this.line[b])}renderSvgPoints(a,b){if(a){const c=this.computeColor(this.entity[b].state,b);return S(_templateObject14(),this.length[b],this.config.animate&&"hover"!==this.config.show.points,this.config.animate?"".concat(.5*b+.5,"s"):"0s",c,c,this.config.line_width/2,a.map((a,c)=>S(_templateObject15(),a[3],a[2],b,this.gradient[b]?this.gradient[b][c].color:"inherit",this.gradient[b]?this.gradient[b][c].color:"inherit",a[0],a[1],this.config.line_width,a=>this.openTooltip(a),()=>this.tooltip={})))}}renderSvgGradient(a){if(a){const b=a.map((a,b)=>{if(a)return S(_templateObject16(),"grad-".concat(b),a.map(a=>S(_templateObject17(),a.color,"".concat(a.offset,"%"))))});return S(_templateObject18(),b)}}renderSvg(){return S(_templateObject19(),this.config.height,a=>a.stopPropagation(),this.renderSvgGradient(this.gradient),this.fill.map((a,b)=>this.renderSvgFill(a,b)),this.line.map((a,b)=>this.renderSvgLine(a,b)),this.points.map((a,b)=>this.renderSvgPoints(a,b)))}openTooltip(b){const c=this.config,d=c.points_per_hour,e=c.hours_to_show,f=.5*(60/d),g=Y(+b.target.id+1-e*d),h=new Date;h.setMinutes(h.getMinutes()-2*f*g-f);const i=ta(h,this.config.hour24);h.setMinutes(h.getMinutes()+2*f);const j=ta(h,this.config.hour24);this.tooltip={value:+b.target.value,id:g,entity:b.target.entity,time:[i,j]}}renderLabels(){if(this.config.show.labels)return k(_templateObject20(),this.computeState(this.bound[1]),this.computeState(this.bound[0]))}renderInfo(){if(this.config.show.extrema)return k(_templateObject21(),this.abs.map(a=>k(_templateObject22(),a.type,this.computeState(a.state),this.computeUom(this.entity[0]),ta(new Date(a.last_changed),this.config.hour24))))}handlePopup(a,b){a.stopPropagation(),this.config.more_info&&this.fire("hass-more-info",{entityId:b.entity_id})}fire(a,b,c){const d=c||{},e=null==b?{}:b,f=new Event(a,{bubbles:void 0===d.bubbles||d.bubbles,cancelable:!!d.cancelable,composed:void 0===d.composed||d.composed});return f.detail=e,this.dispatchEvent(f),f}computeColor(a,b){const c=this.config,d=c.color_thresholds,e=c.line_color,f=_objectSpread({color:e[b]||e[0]},d.find(a=>a.value<(+a||0)));return this.config.entities[b].color||f.color}computeName(a){return this.config.entities[a].name||this.entity[a].attributes.friendly_name}computeIcon(a){return this.config.icon||a.attributes.icon||na[a.attributes.device_class]||na.temperature}computeUom(a){return this.config.unit||a.attributes.unit_of_measurement||""}computeState(a){var b=Math.round;const c=+a,d=this.config.decimals;if(void 0===d||Q(d)||Q(c))return b(100*c)/100;const e=10**d;return(b(c*e)/e).toFixed(d)}async updateData(){let a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this,b=a.config;const c=new Date,d=new Date;d.setHours(c.getHours()-b.hours_to_show);const e=this.entity.map((a,b)=>this.updateEntity(a,b,d,c));await Promise.all(e),this.updateQueue=[],this.bound=[void 0===b.lower_bound?T(...this.Graph.map(a=>a.min))||this.bound[0]:b.lower_bound,void 0===b.upper_bound?R(...this.Graph.map(a=>a.max))||this.bound[1]:b.upper_bound],b.show.graph&&(this.entity.forEach((a,c)=>{var d;a&&0!==this.Graph[c].coords.length&&(d=[this.bound[0],this.bound[1]],this.Graph[c].min=d[0],this.Graph[c].max=d[1],d,this.line[c]=this.Graph[c].getPath(),b.show.fill&&(this.fill[c]=this.Graph[c].getFill(this.line[c])),b.show.points&&(this.points[c]=this.Graph[c].getPoints()),0<b.color_thresholds.length&&!b.entities[c].color&&(this.gradient[c]=this.Graph[c].computeGradient(b.color_thresholds,b.entities[c].color||b.line_color[c]||b.line_color[0])))}),this.line=[...this.line])}async updateEntity(a,b,c,d){if(!a||!this.updateQueue.includes(a.entity_id))return;let e=await this.fetchRecent(a.entity_id,c,d);e[0]&&(1>(e=e[0].filter(a=>!Q(parseFloat(a.state)))).length||(a.entity_id===this.entity[0].entity_id&&(this.abs=[_objectSpread({type:"min"},ra(e,"state")),_objectSpread({type:"max"},sa(e,"state"))]),this.Graph[b].update(e)))}async fetchRecent(a,b,c){let d="history/period";return b&&(d+="/".concat(b.toISOString())),d+="?filter_entity_id=".concat(a),c&&(d+="&end_time=".concat(c.toISOString())),this._hass.callApi("GET",d)}getCardSize(){return 3}})});
